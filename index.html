<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Football Story Pack ‚Äî Editor</title>
<link href="https://fonts.googleapis.com/css2?family=Barlow+Condensed:wght@400;700;900&family=Bebas+Neue&family=Orbitron:wght@500;700;900&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<style>
/* ‚îÄ‚îÄ‚îÄ RESET & BASE ‚îÄ‚îÄ‚îÄ */
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
:root {
  --ui-bg: #070D1A;
  --ui-panel: #0D1628;
  --ui-border: rgba(99,179,255,0.14);
  --ui-accent: #3B82F6;
  --ui-text: #CBD5E1;
  --ui-muted: #4A6080;
  --neon: #00F0FF;
  --neon2: #0099FF;
}
html, body { height: 100%; }
body {
  background: var(--ui-bg);
  color: var(--ui-text);
  font-family: 'Inter', sans-serif;
  font-size: 14px;
  display: flex;
  flex-direction: column;
  min-height: 100vh;
}

/* ‚îÄ‚îÄ‚îÄ TOP BAR ‚îÄ‚îÄ‚îÄ */
.topbar {
  background: rgba(13,22,40,0.95);
  border-bottom: 1px solid var(--ui-border);
  padding: 0 28px;
  height: 56px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  position: sticky;
  top: 0;
  z-index: 100;
  backdrop-filter: blur(12px);
}
.topbar-logo {
  font-family: 'Orbitron', sans-serif;
  font-size: 0.85rem;
  font-weight: 900;
  color: var(--neon);
  letter-spacing: 4px;
  text-shadow: 0 0 16px rgba(0,240,255,0.4);
}
.topbar-tabs {
  display: flex;
  gap: 4px;
  background: rgba(0,0,0,0.3);
  border-radius: 10px;
  padding: 4px;
}
.tab-btn {
  background: none;
  border: none;
  color: var(--ui-muted);
  font-family: 'Orbitron', sans-serif;
  font-size: 0.58rem;
  letter-spacing: 2px;
  padding: 7px 18px;
  border-radius: 7px;
  cursor: pointer;
  transition: all 0.2s;
  text-transform: uppercase;
}
.tab-btn.active {
  background: var(--ui-accent);
  color: #fff;
  box-shadow: 0 0 14px rgba(59,130,246,0.4);
}
.topbar-actions { display: flex; gap: 10px; }
.btn-download {
  background: linear-gradient(135deg, var(--neon2), var(--neon));
  border: none;
  color: #020B18;
  font-family: 'Orbitron', sans-serif;
  font-size: 0.58rem;
  font-weight: 700;
  letter-spacing: 3px;
  padding: 9px 22px;
  border-radius: 8px;
  cursor: pointer;
  text-transform: uppercase;
  box-shadow: 0 0 20px rgba(0,240,255,0.3);
  transition: all 0.2s;
}
.btn-download:hover { transform: translateY(-1px); box-shadow: 0 0 30px rgba(0,240,255,0.5); }
.btn-download:active { transform: translateY(0); }

/* ‚îÄ‚îÄ‚îÄ MAIN LAYOUT ‚îÄ‚îÄ‚îÄ */
.main {
  display: flex;
  flex: 1;
  overflow: hidden;
}

/* ‚îÄ‚îÄ‚îÄ SIDEBAR ‚îÄ‚îÄ‚îÄ */
.sidebar {
  width: 300px;
  flex-shrink: 0;
  background: var(--ui-panel);
  border-right: 1px solid var(--ui-border);
  overflow-y: auto;
  padding: 20px 16px;
  display: flex;
  flex-direction: column;
  gap: 6px;
}
.sidebar::-webkit-scrollbar { width: 4px; }
.sidebar::-webkit-scrollbar-track { background: transparent; }
.sidebar::-webkit-scrollbar-thumb { background: rgba(99,179,255,0.2); border-radius: 2px; }

.section-label {
  font-family: 'Orbitron', sans-serif;
  font-size: 0.52rem;
  letter-spacing: 4px;
  color: var(--neon);
  text-transform: uppercase;
  padding: 10px 4px 4px;
  border-top: 1px solid var(--ui-border);
  margin-top: 6px;
}
.section-label:first-of-type { border-top: none; margin-top: 0; }

.field-row {
  display: flex;
  flex-direction: column;
  gap: 4px;
}
.field-row label {
  font-size: 0.68rem;
  color: var(--ui-muted);
  letter-spacing: 1px;
  text-transform: uppercase;
  padding-left: 2px;
}
.field-row input[type="text"],
.field-row input[type="number"] {
  background: rgba(0,0,0,0.4);
  border: 1px solid var(--ui-border);
  border-radius: 7px;
  color: var(--ui-text);
  font-family: 'Inter', sans-serif;
  font-size: 0.85rem;
  padding: 9px 12px;
  outline: none;
  transition: border-color 0.2s;
  width: 100%;
}
.field-row input:focus { border-color: var(--ui-accent); }

.two-col { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; }

/* score inputs */
.score-row {
  display: grid;
  grid-template-columns: 1fr 40px 1fr;
  align-items: end;
  gap: 8px;
}
.score-sep-lbl {
  text-align: center;
  font-family: 'Bebas Neue', sans-serif;
  font-size: 1.4rem;
  color: var(--ui-muted);
  line-height: 1;
  padding-bottom: 8px;
}

/* color pickers */
.color-row {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 8px;
}
.color-field {
  display: flex;
  flex-direction: column;
  gap: 4px;
}
.color-field label { font-size: 0.65rem; color: var(--ui-muted); letter-spacing: 1px; }
.color-field input[type="color"] {
  width: 100%;
  height: 38px;
  border: 1px solid var(--ui-border);
  border-radius: 7px;
  background: rgba(0,0,0,0.4);
  cursor: pointer;
  padding: 3px;
}

/* format toggle */
.format-toggle {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 6px;
}
.fmt-btn {
  background: rgba(0,0,0,0.3);
  border: 1px solid var(--ui-border);
  border-radius: 8px;
  color: var(--ui-muted);
  font-family: 'Orbitron', sans-serif;
  font-size: 0.55rem;
  letter-spacing: 2px;
  padding: 10px 6px;
  cursor: pointer;
  text-align: center;
  transition: all 0.2s;
  text-transform: uppercase;
}
.fmt-btn.active {
  background: rgba(59,130,246,0.15);
  border-color: var(--ui-accent);
  color: #fff;
  box-shadow: 0 0 12px rgba(59,130,246,0.2);
}
.fmt-btn .fmt-icon { font-size: 1.2rem; display: block; margin-bottom: 4px; }

/* goalscorer inputs */
.scorer-list { display: flex; flex-direction: column; gap: 6px; }
.scorer-entry {
  display: grid;
  grid-template-columns: 1fr 52px 52px 28px;
  gap: 6px;
  align-items: center;
}
.scorer-entry input[type="text"],
.scorer-entry input[type="number"] {
  background: rgba(0,0,0,0.4);
  border: 1px solid var(--ui-border);
  border-radius: 6px;
  color: var(--ui-text);
  font-size: 0.8rem;
  padding: 7px 8px;
  outline: none;
  transition: border-color 0.2s;
  width: 100%;
}
.scorer-entry input:focus { border-color: var(--ui-accent); }
.scorer-entry select {
  background: rgba(0,0,0,0.4);
  border: 1px solid var(--ui-border);
  border-radius: 6px;
  color: var(--ui-text);
  font-size: 0.75rem;
  padding: 7px 4px;
  outline: none;
  cursor: pointer;
}
.btn-remove-scorer {
  background: rgba(255,51,85,0.12);
  border: 1px solid rgba(255,51,85,0.3);
  border-radius: 6px;
  color: #FF3355;
  font-size: 0.9rem;
  cursor: pointer;
  height: 32px;
  display: flex; align-items: center; justify-content: center;
  transition: all 0.2s;
}
.btn-remove-scorer:hover { background: rgba(255,51,85,0.25); }
.btn-add-scorer {
  background: rgba(0,240,255,0.06);
  border: 1px dashed rgba(0,240,255,0.25);
  border-radius: 7px;
  color: var(--neon);
  font-family: 'Orbitron', sans-serif;
  font-size: 0.55rem;
  letter-spacing: 2px;
  padding: 9px;
  cursor: pointer;
  text-align: center;
  transition: all 0.2s;
  text-transform: uppercase;
  margin-top: 2px;
}
.btn-add-scorer:hover { background: rgba(0,240,255,0.1); border-color: var(--neon); }

/* standing rows editor */
.std-row-edit {
  display: grid;
  grid-template-columns: 1fr 28px 28px 28px 28px;
  gap: 5px;
  align-items: center;
}
.std-row-edit input {
  background: rgba(0,0,0,0.4);
  border: 1px solid var(--ui-border);
  border-radius: 6px;
  color: var(--ui-text);
  font-size: 0.78rem;
  padding: 6px 5px;
  text-align: center;
  outline: none;
  transition: border-color 0.2s;
  width: 100%;
}
.std-row-edit input:first-child { text-align: left; padding-left: 8px; }
.std-row-edit input:focus { border-color: var(--ui-accent); }

/* motm extras */
.motm-stats-grid-edit {
  display: grid;
  grid-template-columns: 1fr 1fr 1fr;
  gap: 6px;
}
.motm-stat-edit { display: flex; flex-direction: column; gap: 3px; }
.motm-stat-edit label { font-size: 0.6rem; color: var(--ui-muted); letter-spacing: 1px; }
.motm-stat-edit input {
  background: rgba(0,0,0,0.4);
  border: 1px solid var(--ui-border);
  border-radius: 6px;
  color: var(--ui-text);
  font-size: 0.85rem;
  padding: 7px 8px;
  outline: none;
  text-align: center;
  transition: border-color 0.2s;
}
.motm-stat-edit input:focus { border-color: var(--ui-accent); }

/* rating slider */
.rating-slider-wrap {
  display: flex;
  align-items: center;
  gap: 10px;
}
.rating-slider-wrap input[type="range"] {
  flex: 1;
  accent-color: var(--neon);
  height: 4px;
}
.rating-val-lbl {
  font-family: 'Bebas Neue', sans-serif;
  font-size: 1.3rem;
  color: var(--neon);
  min-width: 36px;
  text-align: right;
}

/* ‚îÄ‚îÄ‚îÄ CANVAS AREA ‚îÄ‚îÄ‚îÄ */
.canvas-area {
  flex: 1;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: flex-start;
  padding: 32px 24px;
  overflow-y: auto;
  background:
    radial-gradient(ellipse 60% 40% at 50% 10%, rgba(0,80,200,0.06) 0%, transparent 60%),
    repeating-linear-gradient(0deg, transparent, transparent 40px, rgba(255,255,255,0.012) 40px, rgba(255,255,255,0.012) 41px),
    repeating-linear-gradient(90deg, transparent, transparent 40px, rgba(255,255,255,0.012) 40px, rgba(255,255,255,0.012) 41px);
}

.preview-wrapper {
  position: relative;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 14px;
}

.preview-label {
  font-family: 'Orbitron', sans-serif;
  font-size: 0.55rem;
  letter-spacing: 4px;
  color: var(--neon);
  text-transform: uppercase;
  border: 1px solid var(--ui-border);
  padding: 4px 16px;
  border-radius: 20px;
}

/* ‚îÄ‚îÄ‚îÄ STORY/POST PREVIEW FRAME ‚îÄ‚îÄ‚îÄ */
#preview-frame {
  position: relative;
  overflow: hidden;
  transition: width 0.35s cubic-bezier(.4,0,.2,1), height 0.35s cubic-bezier(.4,0,.2,1), border-radius 0.35s;
  box-shadow:
    0 0 0 1px rgba(0,240,255,0.15),
    0 0 50px rgba(0,100,255,0.15),
    0 0 100px rgba(0,60,200,0.1);
}
#preview-frame.story-format {
  width: 350px;
  height: 622px;
  border-radius: 20px;
}
#preview-frame.post-format {
  width: 500px;
  height: 500px;
  border-radius: 14px;
}

/* inside the preview frame */
.pf-bg { position: absolute; inset: 0; transition: background 0.4s; }
.pf-noise {
  position: absolute; inset: 0; opacity: 0.04;
  background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)'/%3E%3C/svg%3E");
  background-size: 200px; pointer-events: none;
}
.pf-scanlines {
  position: absolute; inset: 0;
  background: repeating-linear-gradient(0deg, transparent, transparent 3px, rgba(0,240,255,0.01) 3px, rgba(0,240,255,0.01) 4px);
  pointer-events: none;
}
.pf-corners .c { position: absolute; width: 16px; height: 16px; }
.pf-corners .c.tl { top: 10px; left: 10px; border-top: 2px solid; border-left: 2px solid; }
.pf-corners .c.tr { top: 10px; right: 10px; border-top: 2px solid; border-right: 2px solid; }
.pf-corners .c.bl { bottom: 10px; left: 10px; border-bottom: 2px solid; border-left: 2px solid; }
.pf-corners .c.br { bottom: 10px; right: 10px; border-bottom: 2px solid; border-right: 2px solid; }
.pf-watermark {
  position: absolute; bottom: 14px; left: 50%; transform: translateX(-50%);
  font-family: 'Orbitron', sans-serif;
  font-size: 0.5rem; letter-spacing: 5px;
  color: rgba(255,255,255,0.12);
  white-space: nowrap; z-index: 5;
}

/* === SLIDE: RESULT === */
.slide-result { position: absolute; inset: 0; z-index: 2; display: flex; flex-direction: column; }
.res-top {
  display: flex; justify-content: space-between; align-items: flex-start;
  padding: 20px 20px 0; position: relative; z-index: 2;
}
.res-tourn-name {
  font-family: 'Orbitron', sans-serif;
  font-size: 0.56rem; letter-spacing: 3px;
  line-height: 1.4;
}
.res-round { font-size: 0.62rem; color: rgba(255,255,255,0.45); letter-spacing: 2px; margin-top: 2px; }
.res-ft-pill {
  font-family: 'Orbitron', sans-serif;
  font-size: 0.58rem; font-weight: 700; letter-spacing: 2px;
  padding: 5px 14px; border-radius: 4px;
}
.res-teams {
  display: flex; align-items: center; justify-content: center;
  padding: 20px 10px 0; gap: 4px; position: relative; z-index: 2;
}
.res-team-col { flex: 1; display: flex; flex-direction: column; align-items: center; gap: 10px; }
.res-team-name {
  font-family: 'Bebas Neue', sans-serif;
  font-size: 1rem; letter-spacing: 3px; text-align: center;
}
.res-team-city { font-size: 0.6rem; letter-spacing: 2px; text-align: center; color: rgba(255,255,255,0.4); margin-top: -8px; }
.res-score {
  font-family: 'Bebas Neue', sans-serif;
  font-size: 5.5rem; line-height: 1; letter-spacing: -4px;
  text-shadow: 0 0 40px rgba(0,240,255,0.4);
  flex-shrink: 0;
}
.res-divider {
  width: 85%; height: 1px; margin: 16px auto 0; position: relative; z-index: 2;
}
.res-stats {
  display: flex; justify-content: space-around;
  padding: 12px 24px 0; position: relative; z-index: 2;
}
.res-stat { text-align: center; }
.res-stat .rv { font-family: 'Bebas Neue', sans-serif; font-size: 1.5rem; line-height: 1; }
.res-stat .rl { font-size: 0.58rem; letter-spacing: 2px; color: rgba(255,255,255,0.4); text-transform: uppercase; }
.res-scorers {
  padding: 12px 20px 0; position: relative; z-index: 2;
  border-top: 1px solid rgba(255,255,255,0.06); margin: 12px 20px 0;
}
.res-scorers-title { font-family: 'Orbitron', sans-serif; font-size: 0.5rem; letter-spacing: 4px; margin-bottom: 8px; }
.res-goal-entry {
  display: flex; align-items: center; gap: 8px;
  padding: 5px 0; border-bottom: 1px solid rgba(255,255,255,0.04);
  font-size: 0.82rem;
}
.res-goal-entry .gname { flex: 1; font-weight: 700; letter-spacing: 1px; }
.res-goal-entry .gtag { font-size: 0.58rem; padding: 2px 7px; border-radius: 3px; }
.res-goal-entry .gmin { font-size: 0.68rem; color: rgba(255,255,255,0.4); min-width: 26px; text-align: right; }

/* === SLIDE: FIXTURES === */
.slide-fixtures { position: absolute; inset: 0; z-index: 2; display: flex; flex-direction: column; }
.fix-hdr { padding: 20px 20px 0; position: relative; z-index: 2; }
.fix-eyebrow {
  font-family: 'Orbitron', sans-serif; font-size: 0.56rem; letter-spacing: 4px;
  display: flex; align-items: center; gap: 8px; margin-bottom: 2px;
}
.fix-eyebrow::after { content:''; flex:1; height:1px; }
.fix-big-title { font-family: 'Bebas Neue', sans-serif; font-size: 2.8rem; letter-spacing: 7px; line-height: 1; }
.fix-subtitle { font-size: 0.65rem; color: rgba(255,255,255,0.4); letter-spacing: 2px; margin-top: 2px; }
.fix-body-list { padding: 12px 14px 0; display: flex; flex-direction: column; gap: 8px; z-index: 2; position: relative; flex: 1; }
.fix-group-lbl {
  font-size: 0.55rem; color: rgba(255,255,255,0.4); letter-spacing: 3px; text-transform: uppercase;
  padding: 6px 2px 2px; display: flex; align-items: center; gap: 8px;
}
.fix-group-lbl::after { content:''; flex:1; height:1px; background: rgba(255,255,255,0.08); }
.fix-card-p {
  border-radius: 9px; padding: 10px 12px;
  display: flex; align-items: center; gap: 9px; position: relative; overflow: hidden;
}
.fix-card-p::before { content:''; position:absolute; left:0;top:0;bottom:0;width:3px;border-radius:2px 0 0 2px; }
.fix-date-col { display: flex; flex-direction: column; align-items: center; min-width: 30px; }
.fix-date-col .fd { font-family: 'Bebas Neue', sans-serif; font-size: 1.3rem; line-height: 1; }
.fix-date-col .fm { font-size: 0.55rem; color: rgba(255,255,255,0.4); letter-spacing: 1px; }
.fix-vsep { width: 1px; height: 28px; background: rgba(255,255,255,0.1); }
.fix-info { flex: 1; }
.fix-matchup-lbl { font-family: 'Bebas Neue', sans-serif; font-size: 0.95rem; letter-spacing: 2px; }
.fix-venue-lbl { font-size: 0.6rem; color: rgba(255,255,255,0.38); letter-spacing: 1px; margin-top: 1px; }
.fix-time-lbl { font-family: 'Orbitron', sans-serif; font-size: 0.78rem; font-weight: 700; letter-spacing: 1px; }
.fix-live-badge {
  font-family: 'Orbitron', sans-serif; font-size: 0.42rem; font-weight: 700; letter-spacing: 2px;
  padding: 2px 6px; border-radius: 3px; margin-top: 3px; text-align: center;
  animation: blink 1.3s infinite;
}
@keyframes blink { 0%,100%{opacity:1} 50%{opacity:0.3} }

/* === SLIDE: STANDINGS === */
.slide-standings { position: absolute; inset: 0; z-index: 2; display: flex; flex-direction: column; }
.std-hdr-p { padding: 20px 18px 0; display: flex; justify-content: space-between; align-items: flex-end; position: relative; z-index:2; }
.std-eyebrow-p { font-family: 'Orbitron', sans-serif; font-size: 0.55rem; letter-spacing: 3px; }
.std-title-p { font-family: 'Bebas Neue', sans-serif; font-size: 2rem; letter-spacing: 5px; line-height: 1; }
.std-subtitle-p { font-size: 0.62rem; color: rgba(255,255,255,0.4); letter-spacing: 2px; margin-top: 2px; }
.std-trophy { font-size: 2.2rem; }
.std-col-head {
  display: grid; grid-template-columns: 22px 1fr 24px 24px 24px 24px 32px;
  padding: 10px 14px 7px; font-size: 0.54rem; color: rgba(255,255,255,0.38); letter-spacing: 2px;
  border-bottom: 1px solid rgba(255,255,255,0.07); position: relative; z-index:2;
}
.std-col-head > div { text-align: center; }
.std-col-head > div:nth-child(2) { text-align: left; padding-left: 6px; }
.std-rows-p { position: relative; padding: 4px 14px 0; z-index: 2; }
.std-row-p {
  display: grid; grid-template-columns: 22px 1fr 24px 24px 24px 24px 32px;
  align-items: center; padding: 8px 0;
  border-bottom: 1px solid rgba(255,255,255,0.04);
  font-size: 0.8rem; font-weight: 600; position: relative;
}
.std-row-p > div { text-align: center; }
.std-pos-p { font-family: 'Bebas Neue', sans-serif; font-size: 0.95rem; color: rgba(255,255,255,0.45); }
.std-name-p { text-align: left !important; padding-left: 4px; font-family: 'Barlow Condensed', sans-serif; font-weight: 700; font-size: 0.88rem; letter-spacing: 1px; }
.std-col-p { color: rgba(255,255,255,0.45); font-size: 0.76rem; }
.std-pts-p { font-family: 'Bebas Neue', sans-serif; font-size: 1.05rem; }
.std-zone-bar { position: absolute; left: -4px; top:0; bottom:0; width:3px; border-radius:2px; }
.std-legend-p { display: flex; gap: 16px; padding: 8px 14px 0; position: relative; z-index:2; }
.std-leg { display: flex; align-items: center; gap: 5px; font-size: 0.58rem; color: rgba(255,255,255,0.4); letter-spacing: 1px; }
.std-leg .lb { width: 9px; height: 9px; border-radius: 2px; }

/* === SLIDE: MOTM === */
.slide-motm { position: absolute; inset: 0; z-index: 2; display: flex; flex-direction: column; align-items: center; }
.motm-eyebrow-p {
  font-family: 'Orbitron', sans-serif; font-size: 0.55rem; letter-spacing: 5px;
  display: flex; align-items: center; justify-content: center; gap: 10px;
  width: 100%; padding: 20px 20px 0;
}
.motm-eyebrow-p::before, .motm-eyebrow-p::after {
  content:''; width: 30px; height:1px; flex-shrink:0;
}
.motm-avatar-wrap {
  position: relative; width: 110px; height: 110px; margin-top: 14px; flex-shrink:0;
}
.motm-ring-a {
  position: absolute; inset: -8px; border-radius: 50%;
  animation: spinr 3s linear infinite;
}
@keyframes spinr { to { transform: rotate(360deg); } }
.motm-ring-b { position: absolute; inset: -4px; border-radius: 50%; }
.motm-core-a {
  position: absolute; inset: 0; border-radius: 50%;
  border: 2px solid rgba(0,240,255,0.4);
  display: flex; align-items: center; justify-content: center;
  font-size: 3.2rem;
  box-shadow: 0 0 24px rgba(0,240,255,0.2), inset 0 0 16px rgba(0,0,0,0.5);
  z-index: 1;
}
.motm-num-badge {
  position: absolute; bottom: -2px; right: -2px; z-index: 2;
  width: 30px; height: 30px; border-radius: 50%;
  font-family: 'Orbitron', sans-serif; font-size: 0.75rem; font-weight: 900;
  display: flex; align-items: center; justify-content: center;
  border: 2px solid;
}
.motm-name-p {
  font-family: 'Bebas Neue', sans-serif; font-size: 2rem; letter-spacing: 5px;
  line-height: 1; margin-top: 10px; text-align: center;
  text-shadow: 0 0 24px rgba(0,240,255,0.3);
}
.motm-pos-chip {
  font-family: 'Orbitron', sans-serif; font-size: 0.52rem; letter-spacing: 3px;
  padding: 4px 14px; border-radius: 4px; margin-top: 5px;
}
.motm-match-ref { font-size: 0.6rem; color: rgba(255,255,255,0.4); letter-spacing: 2px; margin-top: 4px; }
.motm-stats-p {
  display: grid; grid-template-columns: repeat(3, 1fr); gap: 7px;
  padding: 12px 12px 0; width: 100%;
}
.motm-sc {
  border-radius: 7px; padding: 9px 5px; text-align: center; position: relative; overflow: hidden;
}
.motm-sc::after { content:''; position:absolute; bottom:0;left:0;right:0;height:1px; }
.motm-sc .sv { font-family: 'Bebas Neue', sans-serif; font-size: 1.5rem; line-height: 1; }
.motm-sc .sl { font-size: 0.52rem; letter-spacing: 1.5px; color: rgba(255,255,255,0.45); text-transform: uppercase; margin-top: 2px; }
.motm-rating-p { width: 100%; padding: 10px 12px 0; }
.motm-rating-top { display: flex; justify-content: space-between; align-items: baseline; margin-bottom: 5px; }
.motm-rating-lbl { font-family: 'Orbitron', sans-serif; font-size: 0.52rem; letter-spacing: 3px; color: rgba(255,255,255,0.4); }
.motm-rating-val { font-family: 'Bebas Neue', sans-serif; font-size: 1.5rem; line-height: 1; }
.motm-rtrack { height: 4px; border-radius: 2px; background: rgba(255,255,255,0.07); overflow: hidden; }
.motm-rfill { height: 100%; border-radius: 2px; }
.motm-stars { font-size: 1.1rem; letter-spacing: 4px; margin-top: 8px; }

/* ‚îÄ‚îÄ‚îÄ HIDDEN ELEMENTS FOR SLIDES NOT ACTIVE ‚îÄ‚îÄ‚îÄ */
.slide-hidden { display: none !important; }

/* ‚îÄ‚îÄ‚îÄ DOWNLOAD HINT ‚îÄ‚îÄ‚îÄ */
.dl-hint { font-size: 0.68rem; color: var(--ui-muted); letter-spacing: 1px; text-align: center; }
</style>
</head>
<body>

<!-- TOP BAR -->
<div class="topbar">
  <div class="topbar-logo">‚ö° FOOTPACK</div>
  <div class="topbar-tabs">
    <button class="tab-btn active" onclick="switchSlide('result')">R√©sultat</button>
    <button class="tab-btn" onclick="switchSlide('fixtures')">Fixtures</button>
    <button class="tab-btn" onclick="switchSlide('standings')">Classement</button>
    <button class="tab-btn" onclick="switchSlide('motm')">M.O.T.M</button>
  </div>
  <div class="topbar-actions">
    <button class="btn-download" onclick="downloadImage()">‚¨á T√âL√âCHARGER</button>
  </div>
</div>

<!-- MAIN -->
<div class="main">

  <!-- ‚ïê‚ïê‚ïê SIDEBAR ‚ïê‚ïê‚ïê -->
  <div class="sidebar" id="sidebar">

    <!-- FORMAT -->
    <div class="section-label">Format</div>
    <div class="format-toggle">
      <div class="fmt-btn active" id="fmt-story" onclick="setFormat('story')">
        <span class="fmt-icon">üì±</span>STORY<br><span style="font-size:0.45rem;opacity:0.6">9:16</span>
      </div>
      <div class="fmt-btn" id="fmt-post" onclick="setFormat('post')">
        <span class="fmt-icon">‚¨õ</span>POST<br><span style="font-size:0.45rem;opacity:0.6">1:1</span>
      </div>
    </div>

    <!-- COLORS -->
    <div class="section-label">Couleurs</div>
    <div class="color-row">
      <div class="color-field">
        <label>Neon / Accent</label>
        <input type="color" id="c-neon" value="#00F0FF" oninput="applyColors()">
      </div>
      <div class="color-field">
        <label>Fond principal</label>
        <input type="color" id="c-bg" value="#020B18" oninput="applyColors()">
      </div>
      <div class="color-field">
        <label>Fond secondaire</label>
        <input type="color" id="c-bg2" value="#071428" oninput="applyColors()">
      </div>
      <div class="color-field">
        <label>Texte</label>
        <input type="color" id="c-text" value="#EEF6FF" oninput="applyColors()">
      </div>
    </div>

    <!-- RESULT CONTROLS -->
    <div id="ctrl-result">
      <div class="section-label">Tournoi</div>
      <div class="field-row">
        <label>Nom du tournoi</label>
        <input type="text" id="r-tourn" value="LIGUE DES CHAMPIONS" oninput="updateResult()">
      </div>
      <div class="two-col">
        <div class="field-row">
          <label>Journ√©e</label>
          <input type="text" id="r-round" value="JOURN√âE 6 ¬∑ GROUPE A" oninput="updateResult()">
        </div>
        <div class="field-row">
          <label>Date</label>
          <input type="text" id="r-date" value="24 F√âVR. 2026" oninput="updateResult()">
        </div>
      </div>
      <div class="field-row">
        <label>Stade / Lieu</label>
        <input type="text" id="r-venue" value="Stade Principal" oninput="updateResult()">
      </div>

      <div class="section-label">√âquipes & Score</div>
      <div class="two-col">
        <div class="field-row"><label>√âquipe A</label><input type="text" id="r-team1" value="ATLAS FC" oninput="updateResult()"></div>
        <div class="field-row"><label>Ville A</label><input type="text" id="r-city1" value="MARRAKECH" oninput="updateResult()"></div>
      </div>
      <div class="score-row">
        <div class="field-row" style="grid-column:span 1">
          <label>Score A</label>
          <input type="number" id="r-s1" value="3" min="0" max="99" oninput="updateResult()">
        </div>
        <div class="score-sep-lbl">‚Äì</div>
        <div class="field-row">
          <label>Score B</label>
          <input type="number" id="r-s2" value="1" min="0" max="99" oninput="updateResult()">
        </div>
      </div>
      <div class="two-col">
        <div class="field-row"><label>√âquipe B</label><input type="text" id="r-team2" value="WOLVES SC" oninput="updateResult()"></div>
        <div class="field-row"><label>Ville B</label><input type="text" id="r-city2" value="CASABLANCA" oninput="updateResult()"></div>
      </div>

      <div class="section-label">Buteurs</div>
      <div class="scorer-list" id="scorers-list"></div>
      <button class="btn-add-scorer" onclick="addScorer()">+ Ajouter buteur</button>
    </div>

    <!-- FIXTURES CONTROLS -->
    <div id="ctrl-fixtures" style="display:none">
      <div class="section-label">En-t√™te</div>
      <div class="two-col">
        <div class="field-row"><label>Journ√©e</label><input type="text" id="fx-matchday" value="JOURN√âE 7" oninput="updateFixtures()"></div>
        <div class="field-row"><label>P√©riode</label><input type="text" id="fx-period" value="28 F√âV ‚Äì 2 MARS" oninput="updateFixtures()"></div>
      </div>
      <div class="section-label">Matchs (5 max)</div>
      <div id="fix-matches-list"></div>
    </div>

    <!-- STANDINGS CONTROLS -->
    <div id="ctrl-standings" style="display:none">
      <div class="section-label">En-t√™te</div>
      <div class="two-col">
        <div class="field-row"><label>Groupe</label><input type="text" id="std-group" value="GROUPE A" oninput="updateStandings()"></div>
        <div class="field-row"><label>Journ√©e</label><input type="text" id="std-round" value="JOURN√âE 6" oninput="updateStandings()"></div>
      </div>
      <div class="field-row"><label>Sous-titre</label><input type="text" id="std-sub" value="FOOTBALL ¬∑ SAISON 2025‚Äì26" oninput="updateStandings()"></div>
      <div class="section-label">Classement</div>
      <div style="font-size:0.62rem;color:var(--ui-muted);padding:2px 0 8px;letter-spacing:1px;">√âQUIPE ¬∑ MJ ¬∑ G ¬∑ N ¬∑ P ¬∑ PTS</div>
      <div id="std-rows-edit" style="display:flex;flex-direction:column;gap:6px;"></div>
    </div>

    <!-- MOTM CONTROLS -->
    <div id="ctrl-motm" style="display:none">
      <div class="section-label">Joueur</div>
      <div class="field-row"><label>Nom du joueur</label><input type="text" id="m-name" value="K. HASSAN" oninput="updateMOTM()"></div>
      <div class="two-col">
        <div class="field-row"><label>Poste</label><input type="text" id="m-pos" value="ATTAQUANT" oninput="updateMOTM()"></div>
        <div class="field-row"><label>Num√©ro</label><input type="number" id="m-num" value="10" min="1" max="99" oninput="updateMOTM()"></div>
      </div>
      <div class="field-row"><label>√âquipe</label><input type="text" id="m-team" value="ATLAS FC" oninput="updateMOTM()"></div>
      <div class="field-row"><label>R√©f√©rence match</label><input type="text" id="m-matchref" value="vs WOLVES SC ¬∑ 3‚Äì1 ¬∑ Journ√©e 6" oninput="updateMOTM()"></div>

      <div class="section-label">Statistiques</div>
      <div class="motm-stats-grid-edit" id="motm-stats-edit"></div>

      <div class="section-label">Rating</div>
      <div class="rating-slider-wrap">
        <input type="range" id="m-rating" min="5" max="10" step="0.1" value="9.4" oninput="updateMOTM()">
        <div class="rating-val-lbl" id="rating-display">9.4</div>
      </div>
    </div>

    <div class="section-label">Filigrane</div>
    <div class="field-row">
      <label>Texte watermark</label>
      <input type="text" id="watermark-text" value="@TOURNAMENT ¬∑ 2025‚Äì26" oninput="updateWatermark()">
    </div>

  </div><!-- /sidebar -->

  <!-- ‚ïê‚ïê‚ïê CANVAS AREA ‚ïê‚ïê‚ïê -->
  <div class="canvas-area">
    <div class="preview-wrapper">
      <div class="preview-label" id="format-label">üì± STORY ¬∑ 9:16</div>

      <div id="preview-frame" class="story-format">
        <!-- Shared BG layers -->
        <div class="pf-bg" id="pf-bg"></div>
        <div class="pf-noise"></div>
        <div class="pf-scanlines"></div>
        <div class="pf-corners" id="pf-corners">
          <div class="c tl"></div>
          <div class="c tr"></div>
          <div class="c bl"></div>
          <div class="c br"></div>
        </div>

        <!-- ‚ïê RESULT SLIDE ‚ïê -->
        <div class="slide-result" id="slide-result">
          <div class="res-top">
            <div>
              <div class="res-tourn-name" id="p-tourn">LIGUE DES CHAMPIONS</div>
              <div class="res-round" id="p-round">‚¨° JOURN√âE 6 ¬∑ GROUPE A</div>
            </div>
            <div class="res-ft-pill" id="p-ft-pill">FULL TIME</div>
          </div>
          <div class="res-teams">
            <div class="res-team-col">
              <div class="res-team-name" id="p-team1">ATLAS FC</div>
              <div class="res-team-city" id="p-city1">MARRAKECH</div>
            </div>
            <div class="res-score" id="p-score">3 ‚Äì 1</div>
            <div class="res-team-col">
              <div class="res-team-name" id="p-team2">WOLVES SC</div>
              <div class="res-team-city" id="p-city2">CASABLANCA</div>
            </div>
          </div>
          <div class="res-divider" id="p-divider"></div>
          <div class="res-stats">
            <div class="res-stat"><div class="rv" id="p-poss">62%</div><div class="rl">Possession</div></div>
            <div class="res-stat"><div class="rv" id="p-shots">14</div><div class="rl">Tirs</div></div>
            <div class="res-stat"><div class="rv" id="p-corners">5</div><div class="rl">Corners</div></div>
            <div class="res-stat"><div class="rv" id="p-cards">2</div><div class="rl">Cartons</div></div>
          </div>
          <div class="res-scorers">
            <div class="res-scorers-title" id="p-scorers-title">BUTEURS</div>
            <div id="p-scorers-list"></div>
          </div>
        </div>

        <!-- ‚ïê FIXTURES SLIDE ‚ïê -->
        <div class="slide-fixtures slide-hidden" id="slide-fixtures">
          <div class="fix-hdr">
            <div class="fix-eyebrow" id="fx-eyebrow-p">JOURN√âE 7</div>
            <div class="fix-big-title">FIXTURES</div>
            <div class="fix-subtitle" id="fx-period-p">28 F√âV ‚Äì 2 MARS ¬∑ 2026</div>
          </div>
          <div class="fix-body-list" id="fix-body-p"></div>
        </div>

        <!-- ‚ïê STANDINGS SLIDE ‚ïê -->
        <div class="slide-standings slide-hidden" id="slide-standings">
          <div class="std-hdr-p">
            <div>
              <div class="std-eyebrow-p" id="std-eyebrow-p">GROUPE A ¬∑ JOURN√âE 6</div>
              <div class="std-title-p">CLASSEMENT</div>
              <div class="std-subtitle-p" id="std-subtitle-p">FOOTBALL ¬∑ SAISON 2025‚Äì26</div>
            </div>
            <div class="std-trophy">üèÜ</div>
          </div>
          <div class="std-col-head">
            <div>#</div><div>√âQUIPE</div><div>MJ</div><div>G</div><div>N</div><div>P</div><div>PTS</div>
          </div>
          <div class="std-rows-p" id="std-rows-p"></div>
          <div class="std-legend-p">
            <div class="std-leg"><div class="lb" id="legend-q-dot"></div>Qualification</div>
            <div class="std-leg"><div class="lb" style="background:#FF3355;box-shadow:0 0 5px #FF3355;"></div>√âlimin√©</div>
          </div>
        </div>

        <!-- ‚ïê MOTM SLIDE ‚ïê -->
        <div class="slide-motm slide-hidden" id="slide-motm">
          <div class="motm-eyebrow-p" id="m-eyebrow-p">MAN OF THE MATCH</div>
          <div class="motm-avatar-wrap">
            <div class="motm-ring-a" id="motm-ring-a"></div>
            <div class="motm-ring-b" id="motm-ring-b"></div>
            <div class="motm-core-a" id="motm-core-a">üèÜ</div>
            <div class="motm-num-badge" id="motm-num-badge">10</div>
          </div>
          <div class="motm-name-p" id="m-name-p">K. HASSAN</div>
          <div class="motm-pos-chip" id="m-pos-chip">ATTAQUANT</div>
          <div class="motm-match-ref" id="m-matchref-p">vs WOLVES SC ¬∑ 3‚Äì1 ¬∑ Journ√©e 6</div>
          <div class="motm-stats-p" id="motm-stats-p"></div>
          <div class="motm-rating-p">
            <div class="motm-rating-top">
              <div class="motm-rating-lbl">MATCH RATING</div>
              <div class="motm-rating-val" id="m-rval-p">9.4</div>
            </div>
            <div class="motm-rtrack"><div class="motm-rfill" id="m-rfill-p" style="width:94%"></div></div>
          </div>
          <div class="motm-stars" id="m-stars-p">‚≠ê ‚≠ê ‚≠ê ‚≠ê ‚≠ê</div>
        </div>

        <div class="pf-watermark" id="p-watermark">@TOURNAMENT ¬∑ 2025‚Äì26</div>
      </div><!-- /preview-frame -->

      <div class="dl-hint">Cliquez sur ‚¨á T√âL√âCHARGER pour sauvegarder l'image</div>
    </div>
  </div>

</div><!-- /main -->

<script>
// ‚îÄ‚îÄ‚îÄ STATE ‚îÄ‚îÄ‚îÄ
let currentSlide = 'result';
let currentFormat = 'story';

const scorers = [
  { name: 'K. HASSAN', team: 'A', min: 23 },
  { name: 'M. DIALLO', team: 'A', min: 58 },
  { name: 'Y. MARTINEZ', team: 'B', min: 71 },
  { name: 'K. HASSAN', team: 'A', min: 89 },
];

const fixtures = [
  { day:'28', mon:'F√âV', team1:'ATLAS FC', team2:'FALCONS', venue:'Stade Principal', time:'67\'', type:'live' },
  { day:'28', mon:'F√âV', team1:'WOLVES SC', team2:'TIGERS', venue:'Arena Nord', time:'2‚Äì1', type:'done' },
  { day:'01', mon:'MARS', team1:'DRAGONS', team2:'HAWKS', venue:'Stade Sud', time:'17:30', type:'upcoming' },
  { day:'02', mon:'MARS', team1:'KINGS', team2:'BULLS FC', venue:'Arena Est', time:'20:30', type:'upcoming' },
  { day:'02', mon:'MARS', team1:'SHARKS', team2:'RAYS FC', venue:'Complexe Nord', time:'18:00', type:'upcoming' },
];

const standings = [
  { name:'ATLAS FC', mj:6, g:5, n:1, p:0, pts:16, zone:'q' },
  { name:'WOLVES SC', mj:6, g:3, n:2, p:1, pts:11, zone:'q' },
  { name:'HAWKS', mj:6, g:3, n:0, p:3, pts:9, zone:'' },
  { name:'TIGERS', mj:6, g:2, n:1, p:3, pts:7, zone:'' },
  { name:'DRAGONS', mj:6, g:1, n:2, p:3, pts:5, zone:'' },
  { name:'SHARKS', mj:6, g:0, n:1, p:5, pts:1, zone:'el' },
];

const motmStats = [
  { label:'Buts', val:'2' },
  { label:'Passe D.', val:'1' },
  { label:'Tirs', val:'7' },
  { label:'Passes', val:'94%' },
  { label:'Dribbles', val:'5' },
  { label:'Distance', val:'9km' },
];

// ‚îÄ‚îÄ‚îÄ INIT ‚îÄ‚îÄ‚îÄ
window.onload = () => {
  buildScorersEditor();
  buildFixturesEditor();
  buildStandingsEditor();
  buildMOTMEditor();
  applyColors();
  updateResult();
  updateFixtures();
  updateStandings();
  updateMOTM();
  updateWatermark();
};

// ‚îÄ‚îÄ‚îÄ SLIDE SWITCH ‚îÄ‚îÄ‚îÄ
function switchSlide(name) {
  currentSlide = name;
  document.querySelectorAll('.tab-btn').forEach((b,i) => {
    const names = ['result','fixtures','standings','motm'];
    b.classList.toggle('active', names[i] === name);
  });
  ['result','fixtures','standings','motm'].forEach(s => {
    document.getElementById('slide-'+s).classList.toggle('slide-hidden', s !== name);
    document.getElementById('ctrl-'+s).style.display = (s === name) ? 'block' : 'none';
  });
}

// ‚îÄ‚îÄ‚îÄ FORMAT ‚îÄ‚îÄ‚îÄ
function setFormat(fmt) {
  currentFormat = fmt;
  const frame = document.getElementById('preview-frame');
  const lbl = document.getElementById('format-label');
  document.getElementById('fmt-story').classList.toggle('active', fmt === 'story');
  document.getElementById('fmt-post').classList.toggle('active', fmt === 'post');
  if(fmt === 'story') {
    frame.className = 'story-format';
    lbl.textContent = 'üì± STORY ¬∑ 9:16';
  } else {
    frame.className = 'post-format';
    lbl.textContent = '‚¨õ POST ¬∑ 1:1';
  }
}

// ‚îÄ‚îÄ‚îÄ COLORS ‚îÄ‚îÄ‚îÄ
function applyColors() {
  const neon = document.getElementById('c-neon').value;
  const bg = document.getElementById('c-bg').value;
  const bg2 = document.getElementById('c-bg2').value;
  const txt = document.getElementById('c-text').value;

  const neonRGB = hexToRGB(neon);
  const neonGlow = `rgba(${neonRGB},0.3)`;
  const neonSoft = `rgba(${neonRGB},0.07)`;

  // BG
  document.getElementById('pf-bg').style.background =
    `radial-gradient(ellipse 70% 55% at 50% 35%, rgba(${hexToRGB(bg2)},0.9) 0%, ${bg} 70%)`;

  // Corners
  document.querySelectorAll('.pf-corners .c').forEach(c => c.style.borderColor = neon);

  // Result slide neon elements
  document.getElementById('p-ft-pill').style.background = neon;
  document.getElementById('p-ft-pill').style.color = bg;
  document.getElementById('p-ft-pill').style.boxShadow = `0 0 14px ${neonGlow}`;
  document.getElementById('p-tourn').style.color = neon;
  document.getElementById('p-scorers-title').style.color = neon;
  document.getElementById('p-divider').style.background = `linear-gradient(90deg, transparent, ${neon}, transparent)`;
  document.getElementById('p-divider').style.boxShadow = `0 0 8px ${neon}`;
  document.querySelectorAll('.rv').forEach(el => { el.style.color = neon; });
  document.querySelectorAll('.gtag').forEach(el => { el.style.background = neonSoft; el.style.color = neon; });

  // Fixtures
  document.getElementById('fx-eyebrow-p').style.color = neon;
  const fxLine = document.querySelector('.fix-eyebrow::after');

  // Standings
  document.getElementById('std-eyebrow-p').style.color = neon;
  document.getElementById('legend-q-dot').style.background = neon;
  document.getElementById('legend-q-dot').style.boxShadow = `0 0 5px ${neon}`;

  // MOTM
  document.getElementById('m-eyebrow-p').style.color = neon;
  const motmRing = document.getElementById('motm-ring-a');
  motmRing.style.background = `conic-gradient(${neon} 0deg, rgba(${neonRGB},0.4) 120deg, transparent 180deg, ${neon} 360deg)`;
  document.getElementById('motm-ring-b').style.background = bg;
  document.getElementById('motm-core-a').style.borderColor = `rgba(${neonRGB},0.5)`;
  document.getElementById('motm-core-a').style.boxShadow = `0 0 24px rgba(${neonRGB},0.2), inset 0 0 16px rgba(0,0,0,0.5)`;
  document.getElementById('motm-num-badge').style.background = neon;
  document.getElementById('motm-num-badge').style.color = bg;
  document.getElementById('motm-num-badge').style.borderColor = bg;
  document.getElementById('motm-num-badge').style.boxShadow = `0 0 8px ${neonGlow}`;
  document.getElementById('m-pos-chip').style.background = neonSoft;
  document.getElementById('m-pos-chip').style.border = `1px solid rgba(${neonRGB},0.3)`;
  document.getElementById('m-pos-chip').style.color = neon;
  document.getElementById('m-rval-p').style.color = neon;
  document.getElementById('m-rfill-p').style.background = `linear-gradient(90deg, rgba(${neonRGB},0.7), ${neon})`;
  document.getElementById('m-rfill-p').style.boxShadow = `0 0 8px ${neonGlow}`;
  document.querySelectorAll('.motm-sc .sv').forEach(el => { el.style.color = neon; el.style.textShadow = `0 0 8px ${neonGlow}`; });
  document.querySelectorAll('.motm-sc::after').forEach(el => {}); // css handles
  document.querySelectorAll('.motm-sc').forEach(el => {
    el.style.background = neonSoft;
    el.style.border = `1px solid rgba(${neonRGB},0.15)`;
  });

  // fix body neon line in header
  document.querySelectorAll('.fix-card-p.live-card').forEach(el => {
    el.style.borderColor = `rgba(${neonRGB},0.5)`;
    el.style.background = `rgba(${neonRGB},0.06)`;
  });
  document.querySelectorAll('.fix-time-lbl.live-t').forEach(el => {
    el.style.color = neon;
    el.style.textShadow = `0 0 8px ${neonGlow}`;
  });
  document.querySelectorAll('.fix-live-badge').forEach(el => {
    el.style.background = neon;
    el.style.color = bg;
  });

  // score color
  document.getElementById('p-score').style.textShadow = `0 0 40px rgba(${neonRGB},0.5)`;

  // text color
  document.getElementById('p-score').style.color = txt;
  document.getElementById('motm-name-p') && (document.getElementById('motm-name-p').style.color = txt);

  // std rows first
  const firstRow = document.querySelector('#std-rows-p .std-row-p.top1');
  if(firstRow) {
    firstRow.style.background = `linear-gradient(90deg, rgba(${neonRGB},0.08) 0%, transparent 80%)`;
    firstRow.querySelector('.std-pos-p').style.color = neon;
    firstRow.querySelector('.std-pts-p').style.color = neon;
    firstRow.querySelector('.std-name-p').style.color = neon;
  }
  document.querySelectorAll('.std-pts-p').forEach((el,i)=>{ if(i>0) el.style.color=''; });
  document.querySelectorAll('.std-zone-bar.zq').forEach(el=>{ el.style.background=neon; el.style.boxShadow=`0 0 5px ${neon}`; });
}

function hexToRGB(hex) {
  const r = parseInt(hex.slice(1,3),16);
  const g = parseInt(hex.slice(3,5),16);
  const b = parseInt(hex.slice(5,7),16);
  return `${r},${g},${b}`;
}

// ‚îÄ‚îÄ‚îÄ RESULT ‚îÄ‚îÄ‚îÄ
function updateResult() {
  const tourn = v('r-tourn'), round = v('r-round'), date = v('r-date'), venue = v('r-venue');
  const t1 = v('r-team1'), city1 = v('r-city1'), t2 = v('r-team2'), city2 = v('r-city2');
  const s1 = v('r-s1'), s2 = v('r-s2');

  setText('p-tourn', tourn);
  setText('p-round', '‚¨° ' + round);
  setText('p-team1', t1);
  setText('p-city1', city1);
  setText('p-team2', t2);
  setText('p-city2', city2);
  setText('p-score', s1 + ' ‚Äì ' + s2);

  renderScorers();
}

function renderScorers() {
  const t1 = v('r-team1') || 'A', t2 = v('r-team2') || 'B';
  const list = document.getElementById('p-scorers-list');
  const neon = document.getElementById('c-neon').value;
  const bg = document.getElementById('c-bg').value;
  const neonSoft = `rgba(${hexToRGB(neon)},0.1)`;
  list.innerHTML = scorers.map(s => `
    <div class="res-goal-entry">
      <span>‚öΩ</span>
      <span class="gname">${s.name}</span>
      <span class="gtag" style="background:${neonSoft};color:${neon};">${s.team === 'A' ? t1.split(' ')[0] : t2.split(' ')[0]}</span>
      <span class="gmin">${s.min}'</span>
    </div>
  `).join('');
}

function buildScorersEditor() {
  const list = document.getElementById('scorers-list');
  list.innerHTML = '';
  scorers.forEach((s, i) => {
    const row = document.createElement('div');
    row.className = 'scorer-entry';
    row.innerHTML = `
      <input type="text" placeholder="Nom" value="${s.name}" oninput="scorers[${i}].name=this.value;renderScorers()">
      <select onchange="scorers[${i}].team=this.value;renderScorers()">
        <option value="A" ${s.team==='A'?'selected':''}>A</option>
        <option value="B" ${s.team==='B'?'selected':''}>B</option>
      </select>
      <input type="number" placeholder="Min" value="${s.min}" min="1" max="120" oninput="scorers[${i}].min=+this.value;renderScorers()">
      <button class="btn-remove-scorer" onclick="removeScorer(${i})">√ó</button>
    `;
    list.appendChild(row);
  });
}

function addScorer() {
  scorers.push({ name:'JOUEUR', team:'A', min:1 });
  buildScorersEditor();
  renderScorers();
}

function removeScorer(i) {
  scorers.splice(i,1);
  buildScorersEditor();
  renderScorers();
}

// ‚îÄ‚îÄ‚îÄ FIXTURES ‚îÄ‚îÄ‚îÄ
function buildFixturesEditor() {
  const cont = document.getElementById('fix-matches-list');
  cont.innerHTML = '';
  fixtures.forEach((f, i) => {
    const wrap = document.createElement('div');
    wrap.style.cssText = 'background:rgba(0,0,0,0.2);border:1px solid var(--ui-border);border-radius:8px;padding:10px;margin-bottom:8px;display:flex;flex-direction:column;gap:6px;';
    wrap.innerHTML = `
      <div style="display:flex;gap:6px;align-items:center;">
        <select style="background:rgba(0,0,0,0.4);border:1px solid var(--ui-border);border-radius:6px;color:var(--ui-text);font-size:0.75rem;padding:6px;outline:none;" onchange="fixtures[${i}].type=this.value;updateFixtures()">
          <option value="live" ${f.type==='live'?'selected':''}>üî¥ LIVE</option>
          <option value="done" ${f.type==='done'?'selected':''}>‚úÖ Termin√©</option>
          <option value="upcoming" ${f.type==='upcoming'?'selected':''}>üïê √Ä venir</option>
        </select>
        <input type="text" placeholder="Heure/Score" value="${f.time}" style="background:rgba(0,0,0,0.4);border:1px solid var(--ui-border);border-radius:6px;color:var(--ui-text);font-size:0.8rem;padding:6px 8px;outline:none;flex:1;" oninput="fixtures[${i}].time=this.value;updateFixtures()">
      </div>
      <div style="display:grid;grid-template-columns:1fr 8px 1fr;gap:4px;align-items:center;">
        <input type="text" value="${f.team1}" placeholder="√âquipe A" style="background:rgba(0,0,0,0.4);border:1px solid var(--ui-border);border-radius:6px;color:var(--ui-text);font-size:0.8rem;padding:6px 8px;outline:none;" oninput="fixtures[${i}].team1=this.value;updateFixtures()">
        <div style="text-align:center;color:var(--ui-muted);font-family:'Bebas Neue',sans-serif;">‚Äì</div>
        <input type="text" value="${f.team2}" placeholder="√âquipe B" style="background:rgba(0,0,0,0.4);border:1px solid var(--ui-border);border-radius:6px;color:var(--ui-text);font-size:0.8rem;padding:6px 8px;outline:none;" oninput="fixtures[${i}].team2=this.value;updateFixtures()">
      </div>
      <div style="display:grid;grid-template-columns:1fr 1fr;gap:6px;">
        <input type="text" value="${f.day}" placeholder="Jour" style="background:rgba(0,0,0,0.4);border:1px solid var(--ui-border);border-radius:6px;color:var(--ui-text);font-size:0.8rem;padding:6px 8px;outline:none;text-align:center;" oninput="fixtures[${i}].day=this.value;updateFixtures()">
        <input type="text" value="${f.mon}" placeholder="Mois" style="background:rgba(0,0,0,0.4);border:1px solid var(--ui-border);border-radius:6px;color:var(--ui-text);font-size:0.8rem;padding:6px 8px;outline:none;text-align:center;" oninput="fixtures[${i}].mon=this.value;updateFixtures()">
      </div>
      <input type="text" value="${f.venue}" placeholder="Stade" style="background:rgba(0,0,0,0.4);border:1px solid var(--ui-border);border-radius:6px;color:var(--ui-text);font-size:0.8rem;padding:6px 8px;outline:none;width:100%;" oninput="fixtures[${i}].venue=this.value;updateFixtures()">
    `;
    cont.appendChild(wrap);
  });
}

function updateFixtures() {
  const neon = document.getElementById('c-neon').value;
  const bg = document.getElementById('c-bg').value;
  setText('fx-eyebrow-p', v('fx-matchday'));
  setText('fx-period-p', v('fx-period') + ' ¬∑ 2026');

  const body = document.getElementById('fix-body-p');
  body.innerHTML = '';
  fixtures.forEach(f => {
    const isLive = f.type === 'live';
    const isDone = f.type === 'done';
    const card = document.createElement('div');
    card.className = 'fix-card-p' + (isLive ? ' live-card' : isDone ? ' done' : '');
    if(isLive) {
      card.style.borderColor = `rgba(${hexToRGB(neon)},0.5)`;
      card.style.background = `rgba(${hexToRGB(neon)},0.06)`;
      card.style.boxShadow = `0 0 14px rgba(${hexToRGB(neon)},0.1)`;
    } else {
      card.style.background = `rgba(${hexToRGB(neon)},0.04)`;
      card.style.border = `1px solid rgba(${hexToRGB(neon)},0.14)`;
    }
    const leftBorderColor = isLive ? neon : isDone ? `rgba(${hexToRGB(neon)},0.2)` : `rgba(${hexToRGB(neon)},0.12)`;
    card.style.borderLeft = `3px solid ${leftBorderColor}`;
    card.innerHTML = `
      <div class="fix-date-col">
        <div class="fd" style="color:${neon};text-shadow:0 0 10px rgba(${hexToRGB(neon)},0.4)">${f.day}</div>
        <div class="fm">${f.mon}</div>
      </div>
      <div class="fix-vsep"></div>
      <div class="fix-info">
        <div class="fix-matchup-lbl">${f.team1} vs ${f.team2}</div>
        <div class="fix-venue-lbl">üèü ${f.venue}</div>
      </div>
      <div style="display:flex;flex-direction:column;align-items:flex-end;gap:3px;">
        <div class="fix-time-lbl ${isLive?'live-t':''}" style="color:${isLive?neon:'rgba(255,255,255,0.7)'};${isLive?`text-shadow:0 0 8px rgba(${hexToRGB(neon)},0.5);animation:blink 1.3s infinite;`:''}">${f.time}</div>
        ${isLive ? `<div class="fix-live-badge" style="background:${neon};color:${bg}">LIVE</div>` : ''}
      </div>
    `;
    body.appendChild(card);
  });
}

// ‚îÄ‚îÄ‚îÄ STANDINGS ‚îÄ‚îÄ‚îÄ
function buildStandingsEditor() {
  const cont = document.getElementById('std-rows-edit');
  cont.innerHTML = '';
  standings.forEach((s, i) => {
    const row = document.createElement('div');
    row.style.cssText = 'display:flex;gap:5px;align-items:center;margin-bottom:4px;';
    row.innerHTML = `
      <div style="display:grid;grid-template-columns:1fr 28px 28px 28px 28px 36px;gap:4px;flex:1;">
        <input type="text" value="${s.name}" style="background:rgba(0,0,0,0.4);border:1px solid var(--ui-border);border-radius:5px;color:var(--ui-text);font-size:0.75rem;padding:5px 7px;outline:none;" oninput="standings[${i}].name=this.value;updateStandings()">
        <input type="number" value="${s.mj}" min="0" max="99" style="background:rgba(0,0,0,0.4);border:1px solid var(--ui-border);border-radius:5px;color:var(--ui-text);font-size:0.75rem;padding:5px 3px;outline:none;text-align:center;" oninput="standings[${i}].mj=+this.value;updateStandings()">
        <input type="number" value="${s.g}" min="0" max="99" style="background:rgba(0,0,0,0.4);border:1px solid var(--ui-border);border-radius:5px;color:var(--ui-text);font-size:0.75rem;padding:5px 3px;outline:none;text-align:center;" oninput="standings[${i}].g=+this.value;updateStandings()">
        <input type="number" value="${s.n}" min="0" max="99" style="background:rgba(0,0,0,0.4);border:1px solid var(--ui-border);border-radius:5px;color:var(--ui-text);font-size:0.75rem;padding:5px 3px;outline:none;text-align:center;" oninput="standings[${i}].n=+this.value;updateStandings()">
        <input type="number" value="${s.p}" min="0" max="99" style="background:rgba(0,0,0,0.4);border:1px solid var(--ui-border);border-radius:5px;color:var(--ui-text);font-size:0.75rem;padding:5px 3px;outline:none;text-align:center;" oninput="standings[${i}].p=+this.value;updateStandings()">
        <input type="number" value="${s.pts}" min="0" max="999" style="background:rgba(0,0,0,0.4);border:1px solid var(--ui-border);border-radius:5px;color:var(--ui-text);font-size:0.75rem;padding:5px 3px;outline:none;text-align:center;" oninput="standings[${i}].pts=+this.value;updateStandings()">
      </div>
      <select title="Zone" style="background:rgba(0,0,0,0.4);border:1px solid var(--ui-border);border-radius:5px;color:var(--ui-text);font-size:0.68rem;padding:5px 3px;outline:none;cursor:pointer;" onchange="standings[${i}].zone=this.value;updateStandings()">
        <option value="" ${s.zone===''?'selected':''}>‚Äì</option>
        <option value="q" ${s.zone==='q'?'selected':''}>üîµ Q</option>
        <option value="el" ${s.zone==='el'?'selected':''}>üî¥ E</option>
      </select>
    `;
    cont.appendChild(row);
  });
}

function updateStandings() {
  const neon = document.getElementById('c-neon').value;
  setText('std-eyebrow-p', v('std-group') + ' ¬∑ ' + v('std-round'));
  setText('std-subtitle-p', v('std-sub'));
  document.getElementById('legend-q-dot').style.background = neon;
  document.getElementById('legend-q-dot').style.boxShadow = `0 0 5px ${neon}`;

  const cont = document.getElementById('std-rows-p');
  cont.innerHTML = '';
  standings.forEach((s, i) => {
    const isTop = i === 0;
    const row = document.createElement('div');
    row.className = 'std-row-p' + (isTop ? ' top1' : '');
    if(isTop) row.style.background = `linear-gradient(90deg, rgba(${hexToRGB(neon)},0.08) 0%, transparent 80%)`;
    const neonPts = s.zone === 'el' ? 'rgba(255,255,255,0.35)' : (i < 2 ? neon : 'rgba(255,255,255,0.7)');
    const posColor = isTop ? neon : 'rgba(255,255,255,0.4)';
    const nameColor = isTop ? neon : '#EEF6FF';
    const zoneColor = s.zone==='q' ? neon : s.zone==='el' ? '#FF3355' : 'transparent';
    const zoneShadow = s.zone==='q' ? `0 0 5px ${neon}` : s.zone==='el' ? '0 0 5px #FF3355' : 'none';
    row.innerHTML = `
      ${s.zone ? `<div class="std-zone-bar zq" style="background:${zoneColor};box-shadow:${zoneShadow};"></div>` : ''}
      <div class="std-pos-p" style="color:${posColor}">${i+1}</div>
      <div class="std-name-p" style="color:${nameColor}">${s.name}</div>
      <div class="std-col-p">${s.mj}</div>
      <div class="std-col-p">${s.g}</div>
      <div class="std-col-p">${s.n}</div>
      <div class="std-col-p">${s.p}</div>
      <div class="std-pts-p" style="color:${neonPts}">${s.pts}</div>
    `;
    cont.appendChild(row);
  });
}

// ‚îÄ‚îÄ‚îÄ MOTM ‚îÄ‚îÄ‚îÄ
function buildMOTMEditor() {
  const cont = document.getElementById('motm-stats-edit');
  cont.innerHTML = '';
  motmStats.forEach((s, i) => {
    const wrap = document.createElement('div');
    wrap.className = 'motm-stat-edit';
    wrap.innerHTML = `
      <label>${s.label}</label>
      <input type="text" value="${s.val}" oninput="motmStats[${i}].val=this.value;updateMOTM()">
    `;
    cont.appendChild(wrap);
  });
}

function updateMOTM() {
  const neon = document.getElementById('c-neon').value;
  const bg = document.getElementById('c-bg').value;
  const name = v('m-name'), pos = v('m-pos'), num = v('m-num');
  const team = v('m-team'), matchref = v('m-matchref');
  const rating = document.getElementById('m-rating').value;

  setText('motm-name-p', name);
  setText('m-pos-chip', pos.toUpperCase());
  setText('m-matchref-p', matchref);
  setText('motm-num-badge', num);
  setText('m-rval-p', rating);
  document.getElementById('rating-display').textContent = rating;
  document.getElementById('m-rfill-p').style.width = ((+rating / 10) * 100) + '%';

  const starsCount = Math.round(+rating / 2);
  setText('m-stars-p', '‚≠ê '.repeat(starsCount).trim());

  // stats in preview
  const cont = document.getElementById('motm-stats-p');
  cont.innerHTML = motmStats.map(s => `
    <div class="motm-sc" style="background:rgba(${hexToRGB(neon)},0.05);border:1px solid rgba(${hexToRGB(neon)},0.14);">
      <div class="sv" style="color:${neon};text-shadow:0 0 8px rgba(${hexToRGB(neon)},0.4)">${s.val}</div>
      <div class="sl">${s.label}</div>
    </div>
  `).join('');
}

// ‚îÄ‚îÄ‚îÄ WATERMARK ‚îÄ‚îÄ‚îÄ
function updateWatermark() {
  setText('p-watermark', v('watermark-text'));
}

// ‚îÄ‚îÄ‚îÄ DOWNLOAD ‚îÄ‚îÄ‚îÄ
async function downloadImage() {
  const btn = document.querySelector('.btn-download');
  btn.textContent = '‚è≥ G√âN√âRATION...';
  btn.disabled = true;

  const frame = document.getElementById('preview-frame');
  try {
    const canvas = await html2canvas(frame, {
      scale: 3,
      useCORS: true,
      allowTaint: true,
      backgroundColor: null,
      logging: false,
    });
    const link = document.createElement('a');
    const slideName = currentSlide.charAt(0).toUpperCase() + currentSlide.slice(1);
    link.download = `FootPack_${slideName}_${currentFormat}_${Date.now()}.png`;
    link.href = canvas.toDataURL('image/png');
    link.click();
  } catch(e) {
    alert('Erreur lors du t√©l√©chargement. Veuillez r√©essayer.');
    console.error(e);
  }

  btn.textContent = '‚¨á T√âL√âCHARGER';
  btn.disabled = false;
}

// ‚îÄ‚îÄ‚îÄ UTILS ‚îÄ‚îÄ‚îÄ
function v(id) { return document.getElementById(id)?.value || ''; }
function setText(id, text) { const el = document.getElementById(id); if(el) el.textContent = text; }
</script>
</body>
</html>
